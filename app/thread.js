importScripts("avalon.js","sha256.js");var enabled=!1,loopId,job,jobId,poolId,nonce2;onmessage=function(a){switch(a.data.info){case "stop":close();break;case "pause":enabled=!1;break;case "clean":job=void 0;break;case "newJob":enabled=!1,job=a.data.job,jqId=a.data.jqId,poolId=job.poolId,nonce2=0;case "resume":if(enabled)break;clearTimeout(loopId);enabled=!0;loop()}};
var loop=function(){if(void 0!==job){for(var a=utils.getBlockheader(job,nonce2),c=utils.getMidstate(a),a=utils.gwPool2raw(c,a,poolId,jqId,nonce2),c=[],d=Math.ceil(a.byteLength/33),b=1;b<d+1;b++)c.push(Avalon.pkgEncode(Avalon.P_WORK,0,b,d,a.slice(32*(b-1),32*b)));postMessage(c);nonce2++;enabled&&(loopId=setTimeout(loop,5))}};
